{% extends 'buyerbase.html' %} 

{% block 'body' %}

  <div class="container">
    <br>
    <br>
    {% if products %}


    <!--
      Script for + and - of products 

    -->
    <script>
      function add(id,max,price)
      {
        
        if(Number(document.getElementById(id).value)<Number(max)){
        document.getElementById(id).value=Number(document.getElementById(id).value)+Number(1)
        

        document.getElementById('item').innerHTML=Number(document.getElementById('item').innerHTML)+1
        document.getElementById('price').innerHTML=Number(document.getElementById('price').innerHTML)+price

        document.getElementById('item1').innerHTML=Number(document.getElementById('item1').innerHTML)+1
        document.getElementById('price1').innerHTML=Number(document.getElementById('price1').innerHTML)+price

        document.getElementById('price2').innerHTML=Number(document.getElementById('price2').innerHTML)+price

        //Number(document.getElementById('item').innerHTML)+ Number(document.getElementById('prd_q').innerHTML)

          }
        else
        document.getElementById(id+"-msg").innerHTML="Only "+max+" available"
      
      }
      function sub(id,price)
      {
        if(Number(document.getElementById(id).value)>Number(1)){
        document.getElementById(id).value=Number(document.getElementById(id).value)-Number(1)
        document.getElementById('item').innerHTML=Number(document.getElementById('item').innerHTML)-1
        document.getElementById('price').innerHTML=Number(document.getElementById('price').innerHTML)-price
        document.getElementById('item1').innerHTML=Number(document.getElementById('item1').innerHTML)-1
        document.getElementById('price1').innerHTML=Number(document.getElementById('price1').innerHTML)-price
        document.getElementById('price2').innerHTML=Number(document.getElementById('price2').innerHTML)-price

        } else
        document.getElementById(id+"-msg").innerHTML="Should be 1 atleast"
      }

   
      
    </script>

    <form method="POST" action="/buyer/checkout/">
    

    <div class="row">
      <div class="col-md-7 col-lg-7 mb-4 m-2 card shadow ">
        <br>
        <h1 class='text-center text-muted'>
          <span style="color: chocolate;">Shoping</span> Cart 
        </h1>


        {% for x in products %}
        <hr style="color: chocolate;">
          <div class="row">

            <!-- Image -->
            <div class="col-md-4">
              <img src="{{x.pro_img.url}}" class="rounded"  width="100%" alt=""> </td>
              <br>
            </div>

            <!-- Name and Qty-->
            <div class="col-md-5">
              <h4 class="text-danger font-weight-bold">{{x.name}}</h4> 
              <span id="{{x.id}}-msg" class="text-primary text-center">Usually delivered in 4 to 7 days</span>  
              <br>
              <div class="btn-group btn-group-justified">
                <input type="button" onclick="add({{x.id}},{{x.qty}},{{x.price}})" class="text-dark font-weight-bold border-0" value="+">
                <!-- Hidden Inpit-->
                <input type="hidden" name='price' value="{{x.price}}">
                <input type="hidden" name='pid' value="{{x.id}}">
                <input type="hidden"   value="{{x.id}}">
                
                
                
                 <input type="number" name='pqty' id="{{x.id}}"  value="1"  class="form form-sm text-light  font-weight-bold bg-dark rounded border-0"  size="2" max="{{x.qty}}" style="width: 2em;" min="1"  required readonly>
                 <input  type="button" onclick="sub({{x.id}},{{x.price}})" class=" font-weight-bold text-dark border-0 font-weight-bold" value="-">
               <br>
               </div>
               
              
            </div>

            <!-- Price -->
            <div class="col-md-3">
              <h4 class="text-dark"><i class="fas fa-rupee-sign"></i><span id="pese{{x.id}}" onclick="subTotal({{x.id}})">{{x.price}}
 
              </span>  
              
             
              </h4>
             
              <br>
              <br>

            
              
              
              <a href="{% url 'cartdel' id=x.id %}" class="text-danger "> 
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                  <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z"/>
                </svg>
              </a>
              
          

            </div>
          </div>

        {% endfor %}

        <div class="col-md-12 text-right">
          <hr style="color: chocolate;">
          <h2>
            

            Subtotal (<span id="item">{{count}}</span>) : <i class="fas fa-rupee-sign"></i><span id="price">{{amount}}</span>
          </h2>

        </div>




      </div>
     
        
      <div class="col-md-4 col-lg-4 mb-4 m-2 card shadow ">
          {% csrf_token %}
      
        <br>
        <h2 style="color: chocolate;" class='text-center '>
          Pricing  
          
        </h2>
        <br><br>
        <table  class="table border-0">
          
          <tr>
            <td>
               
              <h4>Price (<span id="item1">{{count}}</span> Items) : </h4>

            </td>
            <td> 
              <h4><i class="fas fa-rupee-sign"></i><span id="price1">{{amount}}</span>
              </h4>
      

            </td>
            
          </tr>

          <tr>
            
            
            <td> <h4> Shipping Charge :</h4></td>
            <td class="text-success "><h4 class="font-weight-bold">FREE</h4></td>


          </tr>


          <tr>
            <td>
              <h4> Total Amount </h4>
            </td>
            <td>
              <h4><i class="fas fa-rupee-sign"></i><span id="price2">{{amount}}</span>
              </h4>
             </td>
            
          </tr>
        </table>            

        <!--hiden input field-->
       
        
        <div class="modal" id="address" tabindex="10" role="dialog">
          <div class="modal-dialog" role="document">
          <div class="modal-content">
              <div class="modal-header">
              <h5 class="modal-title text-warning">Select Address</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
              </div>
              <div class="modal-body container">
                <div class="row">
                
                {% for x in address %} 
                  <div class="col-md-5 card shadow m-2">
                    <div class="card-body">
                      <h5 class="text-dark">{{x.Address_line1}}</h5>
                      <h6 class="text-muted">{{x.city}}<br><span class="text-primary">{{x.mobile}}</span></h6>

                  </div>
                  <div class="card-footer">

                    <!-- Address Hidden Input-->
                    <input type="hidden" value="{{x.id}}" name="address_id">
                    <input type="submit" class="btn btn-outline-warning font-weight-bold form-control" value="Select">
           
                  </div>
                </div>
            
                {% endfor %}
              </div>
                
              <p></p>
              </div>
              <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
          </div>
          </div>
      </div>
      
        
        <a href="#address" data-toggle="modal"  class="btn btn-outline-warning font-weight-bold form-control" >
          Place Order</a>

      
      </div>
     

      <br>
      <br>
      <br>
      
    </div>
    
  </form>
    {% else %} 

    <div class="col-lg-12 shadow">
      <h1 class="text-danger text-center"> 

        Cart is Empty
        <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" fill="currentColor" class="bi bi-cart-x" viewBox="0 0 16 16">
          <path d="M7.354 5.646a.5.5 0 1 0-.708.708L7.793 7.5 6.646 8.646a.5.5 0 1 0 .708.708L8.5 8.207l1.146 1.147a.5.5 0 0 0 .708-.708L9.207 7.5l1.147-1.146a.5.5 0 0 0-.708-.708L8.5 6.793 7.354 5.646z"/>
          <path d="M.5 1a.5.5 0 0 0 0 1h1.11l.401 1.607 1.498 7.985A.5.5 0 0 0 4 12h1a2 2 0 1 0 0 4 2 2 0 0 0 0-4h7a2 2 0 1 0 0 4 2 2 0 0 0 0-4h1a.5.5 0 0 0 .491-.408l1.5-8A.5.5 0 0 0 14.5 3H2.89l-.405-1.621A.5.5 0 0 0 2 1H.5zm3.915 10L3.102 4h10.796l-1.313 7h-8.17zM6 14a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm7 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
        </svg>
      </h1>

      <h1 class="text-center">
      <br>
        <a href="/buyer/home/" class="btn btn-outline-warning ">
          <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-cart4" viewBox="0 0 16 16">
            <path d="M0 2.5A.5.5 0 0 1 .5 2H2a.5.5 0 0 1 .485.379L2.89 4H14.5a.5.5 0 0 1 .485.621l-1.5 6A.5.5 0 0 1 13 11H4a.5.5 0 0 1-.485-.379L1.61 3H.5a.5.5 0 0 1-.5-.5zM3.14 5l.5 2H5V5H3.14zM6 5v2h2V5H6zm3 0v2h2V5H9zm3 0v2h1.36l.5-2H12zm1.11 3H12v2h.61l.5-2zM11 8H9v2h2V8zM8 8H6v2h2V8zM5 8H3.89l.5 2H5V8zm0 5a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0zm9-1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm-2 1a2 2 0 1 1 4 0 2 2 0 0 1-4 0z"/>
          </svg>
          <br>
          Continue Shoping</a>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        
      </h1>
    </div>

    {% endif %}

  </div>
{% endblock %}

